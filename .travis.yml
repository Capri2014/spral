language: c++
# Enable trusty so we have access to libmetis-dev
sudo: required
dist: trusty
# Make OpenMP happy
env:
   global:
      - OMP_NESTED=true
      - OMP_CANCELLATION=true
      - OMP_PROC_BIND=true
      - OMP_NUM_THREADS=4
# Define matrix of builds with different compiler versions
matrix:
   include:
      - compiler: gcc-5
        addons:
           apt:
              sources:
                 - ubuntu-toolchain-r-test
              packages:
                 - gfortran-5
                 - gcc-5
                 - g++-5
                 - libmetis-dev
                 - libatlas-dev
                 - liblapack-dev
        env: CC=gcc-5 CXX=g++-5 FC=gfortran-5 F77=gfortran-5 COMPILER=g++-5
      - compiler: gcc-6
        addons:
           apt:
              sources:
                 - ubuntu-toolchain-r-test
              packages:
                 - gfortran-6
                 - gcc-6
                 - g++-6
                 - libmetis-dev
                 - libatlas-dev
                 - liblapack-dev
        env: CC=gcc-6 CXX=g++-6 FC=gfortran-6 F77=gfortran-6 COMPILER=g++-6
# Don't worry about high git depth, we don't need it
git:
   depth: 3
# Pre build, generate autotools files
install:
   - ./autogen.sh
# Actual build step
script:
   - ./configure && make && make check
