\Preamble{xhtml,mathml}
\usepackage{etoolbox}

% Setup header, add scripts for MathJax
\Configure{VERSION}{}
\Configure{DOCTYPE}{\HCode{<!DOCTYPE html>\Hnewline}}
\Configure{@HEAD}{}
\Configure{@HEAD}{\HCode{<meta charset="UTF-8" />\Hnewline}}
\Configure{@HEAD}{\HCode{<link
         rel="stylesheet" type="text/css"
         href="\expandafter\csname aa:CssFile\endcsname" />\Hnewline}}
\Configure{@HEAD}{\HCode{<script type="text/javascript"\Hnewline
src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"\Hnewline
></script>\Hnewline}}
\Configure{@HEAD}{\HCode{<style type="text/css">\Hnewline
  .MathJax_MathML {text-indent: 0;}\Hnewline
</style>\Hnewline}}
\Configure{@HEAD}{\HCode{<script type="text/javascript">\Hnewline
   MathJax.Hub.Config({\Hnewline
      "HTML-CSS": {\Hnewline
         extensions: ["handle-floats.js"]\Hnewline
      }\Hnewline
   });\Hnewline
</script>\Hnewline}}
% Add jQuery library
\Configure{@HEAD}{\HCode{<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>\Hnewline}}

% Do layout, including forcing a TOC at top of page
\CutAt{chapter}
\Configure{@BODY}{\HCode{\Hnewline<div id="wrapper">\Hnewline}}
\Configure{chapter}{\tableofcontents\HCode{\Hnewline<div id="pkgHeader">\Hnewline<h1>}}{}{}{\HCode{</h1>\Hnewline</div> <!-- pkgHeader -->\Hnewline<div id="pgContent">\Hnewline}}
\Configure{@/BODY}{\HCode{\Hnewline</div> <!--pgContent-->\Hnewline}}
\Configure{@/BODY}{\HCode{\Hnewline</div> <!--wrapper-->\Hnewline}}
% CSS for layout
\Css{
   body, html {
      padding: 0px;
      margin: 0px;
   }
}
\Css{
   wrapper {
      width: 100\%;
   }
}
\Css{
   div.TOC {
      position: fixed;
      left: 0px;
      top: 0px;
      width: 20\%;
      height: 100\%;
      background-color: \#EAEBEA;
      z-index: 10;
   }
}
\Css{
   div\#pkgHeader {
      position: fixed;
      top: 0px;
      left: 0px;
      margin-left: 20\%;
      height: 45px;
      text-align: center;
      background-color: \#EEF8FE;
      z-index: 10;
      width: 80\%;
   }
}
\Css{
   div\#pkgHeader h1 {
      margin: 0px;
   }
}
\Css{
   div\#pgContent {
      position: absolute;
      top: 45px;
      padding-top: 5px;
      margin-left: 20\%;
      padding-left: 5px;
      width: 78\%;
      z-index: 5;
   }
}
% Disable nest/prev/up/etc.
\Configure{crosslinks+}{}{}{}{}

% Add Logo at top of TOC
\newbool{CHAPTERUL}
\Configure{tableofcontents}
   {\HCode{<img src="stfc.png" width="300"/>\Hnewline}\IgnorePar\EndP\HCode{<div class="TOC">\Hnewline<ul>\Hnewline}\boolfalse{CHAPTERUL}\IgnorePar}
   {}
   {
      \IgnorePar
      \HCode{</ul></li>\Hnewline</ul>\Hnewline</div>\Hnewline}
      \HCode{<script type="text/javascript">\Hnewline
         $(document).ready(function() {\Hnewline
            $('.TOC ul ul').hide();\Hnewline
            $('.toc_chapter').click(function() {\Hnewline
                  $(this).find('ul').slideToggle();\Hnewline
                  $(this).find('.toc_indicator').toggleClass('toc_dArrow');\Hnewline
                  $(this).find('.toc_indicator').toggleClass('toc_rArrow');\Hnewline
               });\Hnewline
            });\Hnewline
         </script>\Hnewline
      }
      \ShowPar
   }
   {\HCode{<br />}}
   {}
% Make Package level entries expandable in TOC
\Css{ .TOC ul li { list-style-type: none; } }
\Css{ .TOC > ul { padding-left: 0px; } }
\Css{ span.toc_rArrow {
   background:url('arrow_right16.png');
   width:16px;
   height:16px;
   margin-top:2px;
   display:block;
   float:left;
   }
}
\Css{ span.toc_dArrow {
   background:url('arrow_down16.png');
   width:16px;
   height:16px;
   margin-top:2px;
   display:block;
   float:left;
   }
}
\ConfigureToc{chapter}
   {\ifbool{CHAPTERUL}{\HCode{</ul></li>\Hnewline}}{}\boolfalse{CHAPTERUL}\HCode{<li class="toc_chapter"><span class="toc_rArrow toc_indicator"></span><b>}}
   {~}
   {}
   {\HCode{</b>\Hnewline<ul>\Hnewline}\booltrue{CHAPTERUL}}
\ConfigureToc{section}
   {\HCode{<li>}}
   {~}
   {}
   {\HCode{</li>\Hnewline}}

\begin{document}

\EndPreamble
